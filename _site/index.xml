<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>myblog</title>
<link>https://your-website-url.example.com/</link>
<atom:link href="https://your-website-url.example.com/index.xml" rel="self" type="application/rss+xml"/>
<description>A blog built with Quarto</description>
<generator>quarto-1.8.26</generator>
<lastBuildDate>Sun, 23 Nov 2025 00:00:00 GMT</lastBuildDate>
<item>
  <title>Mapa Interativo de √înibus em Tempo Real ‚Äì Usando a API Olho Vivo</title>
  <dc:creator>Nat√£ Henrique</dc:creator>
  <link>https://your-website-url.example.com/posts/post-with-code/</link>
  <description><![CDATA[ 





<section id="introdu√ß√£o" class="level2">
<h2 class="anchored" data-anchor-id="introdu√ß√£o">Introdu√ß√£o</h2>
<p>Neste post mostro como constru√≠ um mapa interativo usando Python, Folium e a API p√∫blica Olho Vivo da SPTrans.</p>
<hr>
</section>
<section id="autentica√ß√£o-na-api-e-busca-da-linha" class="level2">
<h2 class="anchored" data-anchor-id="autentica√ß√£o-na-api-e-busca-da-linha">Autentica√ß√£o na API e busca da linha</h2>
<div id="1172504f" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> requests</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> folium</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> webbrowser</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-5"></span>
<span id="cb1-6">TOKEN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b07b39ca6bcf06d0e3b9f3e54c99fd54e03ebcde54736c1badfea0daf3f92805"</span></span>
<span id="cb1-7">BASE_URL <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://api.olhovivo.sptrans.com.br/v2.1"</span></span>
<span id="cb1-8"></span>
<span id="cb1-9">session <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.Session()</span>
<span id="cb1-10">auth <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> session.post(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>BASE_URL<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/Login/Autenticar?token=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>TOKEN<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> auth.json() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>:</span>
<span id="cb1-13">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Falha na autentica√ß√£o!"</span>)</span>
<span id="cb1-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">SystemExit</span>()</span>
<span id="cb1-15"></span>
<span id="cb1-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Autenticado com sucesso!"</span>)</span>
<span id="cb1-17"></span>
<span id="cb1-18">linha_digitada <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"697"</span></span>
<span id="cb1-19">resp_linhas <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> session.get(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>BASE_URL<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/Linha/Buscar?termosBusca=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>linha_digitada<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-20">linhas <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> resp_linhas.json()</span>
<span id="cb1-21"></span>
<span id="cb1-22"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> linhas:</span>
<span id="cb1-23">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linha n√£o encontrada!"</span>)</span>
<span id="cb1-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">SystemExit</span>()</span>
<span id="cb1-25"></span>
<span id="cb1-26">linha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> linhas[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb1-27">codigo_linha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> linha[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cl'</span>]</span>
<span id="cb1-28">linha</span></code></pre></div></div>
<div class="cell-output cell-output-stdout">
<pre><code>Autenticado com sucesso!</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>{'cl': 1505,
 'lc': False,
 'lt': '6970',
 'sl': 1,
 'tl': 10,
 'tp': 'TERM. STO. AMARO',
 'ts': 'TERM. GRAJA√ö'}</code></pre>
</div>
</div>
<p>Aqui realizo o login na API, procuro a linha informada e obtenho o c√≥digo interno da linha, necess√°rio para consultar paradas e ve√≠culos.</p>
<p>üîπ Buscando paradas e gerando o mapa base</p>
<div id="26d6e4ec" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">resp_paradas <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> session.get(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>BASE_URL<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/Parada/BuscarParadasPorLinha?codigoLinha=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>codigo_linha<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb4-2">paradas <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> resp_paradas.json()</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> paradas:</span>
<span id="cb4-5">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nenhuma parada encontrada!"</span>)</span>
<span id="cb4-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">SystemExit</span>()</span>
<span id="cb4-7"></span>
<span id="cb4-8">lat_centro <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> paradas[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"py"</span>]</span>
<span id="cb4-9">lon_centro <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> paradas[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>]</span>
<span id="cb4-10"></span>
<span id="cb4-11">mapa <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> folium.Map(location<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[lat_centro, lon_centro], zoom_start<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)</span>
<span id="cb4-12"></span>
<span id="cb4-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> paradas:</span>
<span id="cb4-14">    folium.Marker(</span>
<span id="cb4-15">        location<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[p[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"py"</span>], p[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>]],</span>
<span id="cb4-16">        popup<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>p[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"np"</span>],</span>
<span id="cb4-17">        icon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>folium.Icon(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, icon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bus"</span>)</span>
<span id="cb4-18">    ).add_to(mapa)</span>
<span id="cb4-19"></span>
<span id="cb4-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(paradas)</span></code></pre></div></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>15</code></pre>
</div>
</div>
<p>Aqui consulto todas as paradas da linha e marco cada uma no mapa usando Folium.</p>
<p>üîπ Obtendo a posi√ß√£o dos √¥nibus e finalizando o mapa</p>
<div id="af42dd3a" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">resp_posicao <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> session.get(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>BASE_URL<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/Posicao/Linha?codigoLinha=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>codigo_linha<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb6-2">dados <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> resp_posicao.json()</span>
<span id="cb6-3"></span>
<span id="cb6-4">onibus <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dados.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vs"</span>, [])</span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> bus <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> onibus:</span>
<span id="cb6-7">    folium.Marker(</span>
<span id="cb6-8">        location<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[bus[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"py"</span>], bus[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"px"</span>]],</span>
<span id="cb6-9">        popup<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Prefixo: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bus<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'p'</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> ‚Äì Velocidade: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bus<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'v'</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> km/h"</span>,</span>
<span id="cb6-10">        icon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>folium.Icon(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, icon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"info-sign"</span>)</span>
<span id="cb6-11">    ).add_to(mapa)</span>
<span id="cb6-12">    mapa.save(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mapa_onibus.html"</span>)</span></code></pre></div></div>
</div>
<p>Explica√ß√£o Aqui marco cada √¥nibus ativo no mapa.</p>
<p>Conclus√£o Com poucos blocos de c√≥digo conseguimos autenticar, consultar linha, paradas, posi√ß√£o dos ve√≠culos e exibir tudo em um mapa interativo.</p>
</section>
<section id="mapa-final" class="level2">
<h2 class="anchored" data-anchor-id="mapa-final">Mapa Final</h2>
<iframe src="mapa_onibus.html" width="100%" height="600px" style="border:none;">
</iframe>


</section>

 ]]></description>
  <category>api</category>
  <category>python</category>
  <category>maps</category>
  <guid>https://your-website-url.example.com/posts/post-with-code/</guid>
  <pubDate>Sun, 23 Nov 2025 00:00:00 GMT</pubDate>
  <media:content url="https://your-website-url.example.com/posts/post-with-code/busao.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Welcome To My Blog</title>
  <dc:creator>Tristan O&#39;Malley</dc:creator>
  <link>https://your-website-url.example.com/posts/welcome/</link>
  <description><![CDATA[ 





<p>This is the first post in a Quarto blog. Welcome!</p>
<p><img src="https://your-website-url.example.com/posts/welcome/thumbnail.jpg" class="img-fluid"></p>
<p>Since this post doesn‚Äôt specify an explicit <code>image</code>, the first image in the post will be used in the listing page of posts.</p>



 ]]></description>
  <category>news</category>
  <guid>https://your-website-url.example.com/posts/welcome/</guid>
  <pubDate>Thu, 20 Nov 2025 00:00:00 GMT</pubDate>
</item>
</channel>
</rss>
